(function(){var c=null;function f(a){var b=j;function e(){}e.prototype=b.prototype;a.j=b.prototype;a.prototype=new e};function j(a,b,e){this.type=a;this.b=!0;this.h=!1;this.x=b;this.y=e;this.d=Math.floor((e+60)/60)-1;this.e=Math.floor((b+60)/60)-1}j.prototype.g=function(){if(this.type){var a=new paper.Raster(this.type);a.position=new paper.Point(a.size.width/2+this.x,a.size.height/2+this.y)}};function l(a,b){j.call(this,"grass",a,b);this.b=!0}f(l);var m=[[{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"grass"},{type:"pathv"},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"}],[{type:"treem"},{},{},{},{},{},{},{},{},{},{},{},{type:"treem"},{},{type:"grass"},{type:"pathv"},{},{type:"treem"},{},{},{},{},{},{},{},{},{type:"treem"}],[{type:"treem"},{},{type:"wall"},{type:"wallEnd"},{type:"wallEnd"},{type:"wallEnd"},
{type:"wallEnd"},{type:"wallEnd"},{type:"wall"},{type:"treem"},{},{},{},{},{},{type:"pathv"},{},{},{type:"treem"},{},{},{},{},{},{},{},{type:"treem"}],[{type:"treem"},{},{type:"wall"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"wall"},{},{},{},{},{},{},{type:"pathv"},{},{},{},{},{},{},{},{},{type:"treem"},{},{type:"treem"}],[{type:"treem"},{},{type:"wall"},{type:"grass"},{type:"house"},{type:c},{type:c},{type:"grass"},{type:"wall"},{},{},{},{},{},{},{type:"pathv"},
{},{},{type:"treem"},{},{},{},{},{},{},{},{}],[{type:"treem"},{},{type:"wall"},{type:"grass"},{type:c},{type:c},{type:c},{type:"grass"},{type:"wallEnd"},{},{},{},{},{},{},{type:"pathv"},{},{},{},{},{},{},{},{},{},{},{}],[{type:"treem"},{},{type:"wallEnd"},{type:"grass"},{type:c},{type:c},{type:c},{type:"grass"},{},{},{},{},{},{type:"treem"},{},{type:"pathv"},{},{},{},{},{},{},{type:"treem"},{},{},{},{}],[{type:"treem"},{},{type:"treem"},{},{},{type:"pathv"},{},{},{},{},{},{},{},{},{},{type:"pathv"},
{},{},{},{},{},{},{},{},{},{},{}],[{type:"treem"},{},{type:"treem"},{},{},{type:"pathv"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathv"},{type:"treem"},{},{},{},{},{},{},{},{},{},{type:"treem"}],[{type:"treem"},{},{},{},{},{type:"pathv"},{type:"grass"},{type:"grass"},{},{},{},{},{},{},{type:"treem"},{type:"pathv"},{type:"treem"},{},{type:"grass"},{},{},{},{},{},{},{},{type:"treem"}],[{type:"treem"},
{},{type:"treem"},{},{},{type:"pathv"},{},{},{type:"treem"},{},{},{},{},{},{},{type:"treem"},{},{},{},{type:"grass"},{},{},{},{},{},{},{type:"treem"}],[{},{},{},{},{},{type:"pathv"},{},{},{},{},{},{},{},{},{},{},{},{type:"grass"},{type:"grass"},{},{},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"}],[{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathh"},{type:"pathv"},{type:"treem"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{type:"treem"}],[{type:"treem"},
{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],[{},{},{},{},{},{},{type:"treem"},{},{},{},{},{type:"grass"},{},{},{},{},{},{type:"treem"},{},{type:"treem"},{},{},{},{},{},{},{type:"treem"}],[{},{},{},{},{},{type:"grass"},{},{},{},{},{},{type:"grass"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{type:"treem"}],[{},{},{type:"treem"},{},{type:"treem"},{},{type:"treem"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{type:"treem"}]];function n(a,b){j.call(this,"house",a,b);this.b=!1}f(n);function o(a){j.call(this,c,0,0);this.b=a;this.h=!0}f(o);function p(a,b){j.call(this,"treem",a,b);this.b=!0;if(m[this.d+1])m[this.d+1][this.e].type?m[this.d+1][this.e].b=!1:m[this.d+1][this.e]={type:"",item:new o(!1)};if(m[this.d+1]&&m[this.d+1][this.e+1])m[this.d+1][this.e+1].type?m[this.d+1][this.e+1].b=!1:m[this.d+1][this.e+1]={type:"",item:new o(!1)}}f(p);function q(){this.type="female"}q.prototype.g=function(){this.a=new paper.Raster(this.type);this.a.position=new paper.Point(this.a.size.width/2+600,this.a.size.height/2+600);this.move={c:c,f:0};var a=this;(new paper.Tool).onKeyDown=function(b){a.move.f==0&&a.moveTo(b.key)}};q.prototype.moveTo=function(a){this.move.c=a;this.move.f=60};
q.prototype.onFrame=function(){var a;if(a=this.move.f>0)a:{if(this.move.f==60){a=Math.floor(this.a.position.x/60);this.move.c=="right"?a=Math.floor((this.a.position.x+60)/60):this.move.c=="left"&&(a=Math.floor((this.a.position.x-60)/60));var b=Math.floor(this.a.position.y/60);this.move.c=="up"?b=Math.floor((this.a.position.y-60)/60):this.move.c=="down"&&(b=Math.floor((this.a.position.y+60)/60));if((a=m[b]?m[b][a]:c)&&a.item&&!a.item.b){this.move.c=c;this.move.f=0;a=!1;break a}}a=!0}a&&(this.move.c==
"right"&&(this.a.position.x+=4),this.move.c=="left"&&(this.a.position.x-=4),this.move.c=="up"&&(this.a.position.y-=4),this.move.c=="down"&&(this.a.position.y+=4),this.move.f-=4)};function r(){this.i=new q}r.prototype.draw=function(){paper.project.activeLayer.removeChildren();s();t(this);u();var a=new Date,b=0,e=new paper.PointText({content:"FPS (0)",point:new paper.Point(20,30),fillColor:"black"}),i=this;paper.view.onFrame=function(){b++;var d=new Date,k=1E3/(d-a);a=d;if(b>=5)e.content="FPS ("+Math.round(k).toString()+")",b=0;i.i.onFrame()}};
function s(){for(var a=Math.round(paper.view.size.width/60),b=0,e=Math.round(paper.view.size.height/60);b<e;b++){m[b]||(m[b]=[]);for(var i=0,d=a;i<d;i++)m[b][i]||(m[b][i]={})}}
function t(a){for(var b=0,e=0,i=[],d=0,k=m.length;d<k;d++){for(var g=0,w=m[d].length;g<w;g++){var h=m[d][g];if(!h.item||h.item&&h.item.h){if(h.type=="grass")m[d][g].item=new l(b,e),m[d][g].item.g();else if(h.type=="treem")m[d][g].item=new p(b,e),i.push(m[d][g].item);else if(h.type=="house")m[d][g].item=new n(b,e),m[d][g].item.g();else if(h.type)m[d][g].item=new j(h.type,b,e),h.h||m[d][g].item.g();if(h.b!=void 0)m[d][g].item.b=h.b}b+=60}b=0;e+=60}a.i.g();a=0;for(k=i.length;a<k;a++)i[a].g()}
function u(){for(var a=60,b=60;;)if((new paper.Path.Line(new paper.Point(0,b),new paper.Point(paper.view.size.width,b))).strokeColor="#5BB01B",b+=60,b>paper.view.size.height)break;for(;;)if((new paper.Path.Line(new paper.Point(a,0),new paper.Point(a,paper.view.size.height))).strokeColor="#5BB01B",a+=60,a>paper.view.size.width)break}var v=new r;paper.setup(document.getElementById("canvas"));v.draw();paper.view.draw();paper.view.play();paper.view.onResize=function(){v.draw()};})();
